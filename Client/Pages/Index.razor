@page "/"

@using System.Collections.Generic
@using System.Net.Http
@using EliteHelper

@inject HttpClient httpClient

<h1>Hello, world!</h1>

Welcome to your new app.

Let's hook up to the Elite Dangerous Player Journal.
Journals: @(journals.Count)
@foreach(var journal in journals)
{
    <p>
        <span>Journal: </span>
        <span>@(journal.Filename) </span>
        <span>@(journal.DisplayName) </span>
    </p>
}

@code {


    List<Journal> journals = new List<Journal>();

    protected override async Task OnInitializedAsync()
    {
        string baseUri = "https://localhost:5001";
        string endpoint = "Journal";
        string uri = $@"{baseUri}/{endpoint}";

        var request = new HttpRequestMessage(HttpMethod.Get, uri);
        request.SetBrowserRequestMode(BrowserRequestMode.Cors);
        var response = await httpClient.SendAsync(request);
        var content = await response.Content.ReadAsStringAsync();
        journals = System.Text.Json.JsonSerializer.Deserialize<List<Journal>>(content);
    }
}